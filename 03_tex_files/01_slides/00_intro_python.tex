% select theme
\input{../preamble_theme_2}

% ====================================================
% ====================================================
% OPTIONS
% ====================================================
% ====================================================

% number of levels in toc
\dwDeepToc{false}

\newcommand{\code}[2][fill=lightgray!50]{%
	\tikz[baseline]\node[%
        	inner ysep=0.5pt, 
        	inner xsep=2pt, 
        	anchor=text, 
        	rectangle, 
        	rounded corners=1mm,
        	#1] {\strut \texttt{#2}};%
}

% ====================================================
% ====================================================
% PRESENTATION DATA
% ====================================================
% ====================================================

\title[Introduction to Python for ML]{***** Introduction to Python for ML *****}
\author{Daniel Wehner, M.Sc.}
\institute[SAP\,SE]{SAP\,SE / DHBW Mannheim}
\date{Winter term 2020/2021}

% ====================================================
% ====================================================
% BEGIN OF DOCUMENT
% ====================================================
% ====================================================

\begin{document}

% Title frame
%______________________________________________________________________
\dwPrintTitle

% Agenda
%______________________________________________________________________
\dwPrintToc

% Section: Introduction
%______________________________________________________________________
\dwSection{Introduction}

% What is Python?
\begin{dwHeaderFrame}{What is Python?}
	\begin{itemize}
		\item Python was developed by Guido van Rossum in the early 1990s.
		\item It is an interpreted, high-level, general-purpose programming language which is the state-of-the-art for data science and machine learning.
		\item \textbf{White space has a meaning!} (important difference to other languages like Java or C++)
		\begin{itemize}
			\item Semantic code blocks (e.\,g. conditions, loops, ...) have to be indented.
			\item You may use tabs or spaces for indentation, but the interpreter \textbf{does not allow you to mix these two!}
		\end{itemize}
		\item Python supports many programming paradigms: We can write \textbf{procedural}, \textbf{functional} or \textbf{object-oriented} programs.
	\end{itemize}
\end{dwHeaderFrame}


\begin{frame}
	\begin{itemize}
		\item \textbf{Caveat:} Python has two \textbf{non-compatible} branches:
		\begin{itemize}
			\item \texttt{Python 2.7} $\Longleftarrow$ This one is deprecated and no longer maintained
			\item \texttt{Python 3.x} $\Longleftarrow$ Use this one!
		\end{itemize}
	\end{itemize}
\end{frame}


% Installation and Components
\begin{dwHeaderFrame}{Installation and Components}
	\dwHeader{Python}
	\begin{itemize}
		\item Python is pre-installed on Mac and Linux. You may check this by executing \texttt{python -V} in the command line.
		\item For Windows (and Mac), download the newst version from \externalurl{www.python.org/downloads/}{www.python.org/downloads/}.
		\item Don't forget to check the \texttt{`Add Python 3.x to PATH'} option!
	\end{itemize}
	\dwHeader{Jupyter}
	\begin{itemize}
		\item It is a browser-based Python environment (either on local or remote machine).
		\item The code is editable directly in the browser.
		\item Nice for (interactive) demonstrations, \textbf{but hard to debug}.
	\end{itemize}
\end{dwHeaderFrame}


\begin{frame}
	\dwHeader{Anaconda}
	\begin{itemize}
		\item A package manager for creating \textbf{isolated Python environments} (with different package versions)
		\item It is good programming practice to create separate environments for different projects in order to avoid version mismatches,
			package clashes etc.
		\item It can be downloaded from \externalurl{https://www.anaconda.com/download/}{https://www.anaconda.com/download/}
	\end{itemize}
	
	\dwInfoBox{I recommend to use the \textit{Anaconda Navigator} which combines all components, including a Python IDE called \textit{spyder}.}
\end{frame}


% Writing and running Python Scripts
\begin{dwHeaderFrame}{Writing and running Python Scripts}

\end{dwHeaderFrame}


\begin{frame}
	\lstinputlisting{00_intro_python/06_listings/test.txt}
\end{frame}


% Section: Variables and Data Types
%______________________________________________________________________
\dwSection{Variables and Data Types}

% Basic Data Types
\begin{dwHeaderFrame}{Basic Data Types}
	\begin{itemize}
		\item Unlike Java, Python is \textbf{typed dynamically}, i.\,e. the data type does not have to be specified when declaring variables.
		\item Nevertheless, Python works with these types internally (cf. \cref{tab:data_types}).
	\end{itemize}
	
	\input{00_intro_python/03_tbl/data_types}
\end{dwHeaderFrame}


\begin{frame}
	\dwHeader{Some examples}
	\lstinputlisting{00_intro_python/06_listings/data_types_string.txt}
\end{frame}


\begin{frame}{}
	\dwHeader{Conversion between Types}
	\begin{itemize}
		\item Although you don't have to bother with types in Python, you may want to convert a variable to another type.
		\item E.\,g. when concatenating a number to a string
	\end{itemize}
	
	\lstinputlisting{00_intro_python/06_listings/type_conversion.txt}
\end{frame}


\begin{frame}
	\dwHeader{Immutable data types}
	\lstinputlisting{00_intro_python/06_listings/immutable_data_types.txt}
\end{frame}


% Sequence Data Types
\begin{dwHeaderFrame}{Sequence Data Types}
	\begin{itemize}
		\item Sometimes it is necessary to store multiple elements in one place.
			Think e.\,g. of a list of data points which we want to analyze using machine learning methods.
		\item Python offers the types \code{range}, \code{list} and \code{tuple} for that. 
	\end{itemize}
	
	\dwHeader{Ranges}
	\begin{itemize}
		\item The \code{range} type represents an immutable sequence of numbers and is commonly used for looping a specific number of times in for-loops.
		\item \textbf{Interface:} class \texttt{range}(\textit{start}, \textit{stop}[, \textit{step}])
		\begin{itemize}
			\item \textit{start}: Fist point in the sequence of numbers (default = 0).
			\item \textit{stop}: Last point in the sequence of numbers (excluding).
			\item \textit{step}: Step size
		\end{itemize}
	\end{itemize}
\end{dwHeaderFrame}
	
	
\begin{frame}
	\dwHeader{Lists}
	\begin{itemize}
		\item Lists are \textbf{mutable} sequences of elements (i.\,e. elements can be inserted, modified, deleted).
		\item Lists can be constructed in several ways:
		\begin{itemize}
			\item Using a pair of square brackets (empty list): \code{[]}
			\item Using square brackets, separating items with commas: \code{[a]}, \code{[a, b, c]}
			\item Using the type constructor: \code{list()} or \code{list(iterable)}
			\item Using a \textbf{list comprehension}: \code{[x for x in iterable]}
		\end{itemize}
		\item Example: \code{list(range(1, 10)) = [1, 2, 3, 4, 5, 6, 7, 8, 9]}
	\end{itemize}
	
	\dwInfoBox{Lists are commonly used to store \textit{homogeneous} types of elements, e.\,g. a list of customers.}
\end{frame}


\begin{frame}
	\begin{itemize}
		\item List comprehensions originate from \textbf{functional programming} and provide a concise way to create lists.
		\item Common applications are to make new lists where each element is the result of some operations applied to each member of
			another sequence or iterable, or to create a subsequence of those elements that satisfy a certain condition.
		\item Example: Compute square numbers:
	\end{itemize}
	
	\lstinputlisting{00_intro_python/06_listings/list_comprehensions.txt}
	\dwInfoBox{Task: Create a list of prime numbers up to $n$ by using list comprehensions only!}
\end{frame}


\begin{frame}
	\dwHeader{Excursion: Sets}
	\begin{itemize}
		\item Python also includes a data type for sets.
		\item Following the mathematical notion of a set, it is an \textbf{unordered} collection with \textbf{no duplicate} elements.
		\item A set can be created using \code{set()} (not \code{\{\}}!)
		\item \code{set([4, 1, 2, 2, 6])} gives \code{\{ 1, 2, 4, 6 \}}
		\item \code{set([4, 1, 2, 2, 6]) == set([4, 4, 4, 1, 2, 6, 2])} evaluates to \code{True}!
	\end{itemize}
\end{frame}


\begin{frame}
	\dwHeader{Tuples}
	\begin{itemize}
		\item Tuples are \textbf{immutable} sequences, typically used to store collections of \textbf{heterogeneous} data (it is not enforced, though).
		\item Think e.\,g. of a customer record which includes the name, address and contact.
		\item Tuples can be constructed in several ways:
		\begin{itemize}
			\item Using a pair of parentheses (empty tuple): \code{()}
			\item Using a trailing comma for a singleton tuple: \code{a,} or \code{(a,)}
			\item Separating items with commas: \code{a, b, c} or \code{(a, b, c)}
			\item Using the \code{tuple()} built-in: \code{tuple()} or \code{tuple(iterable)}
		\end{itemize}
	\end{itemize}
\end{frame}


% Mapping Types
\begin{dwHeaderFrame}{Mapping Types}
	\begin{itemize}
		\item A mapping object maps hashable values to arbitrary objects.
		\item Mappings are \textbf{mutable} objects.
		\item There is currently only one standard mapping type, the \textbf{dictionary} -- \code{dict}.
		\item A dictionary consists of key-value pairs. Consider it to be a telephone book where the keys are the names and the values are the numbers.
		\item A dictionaryâ€™s keys are almost arbitrary values. Values that are not hashable, that is, values containing lists,
			dictionaries or other mutable types (that are compared by value rather than by object identity) may \textbf{not} be used as keys.
		\item Dictionaries can be created in two ways:
		\begin{itemize}
			\item A comma-separated list of key-value pairs: \code{\{ key1: value1, key2: value2, ... \}}
			\item By using the \code{dict()} constructor.
		\end{itemize}
	\end{itemize}
\end{dwHeaderFrame}


\begin{frame}
	\lstinputlisting{00_intro_python/06_listings/dicts.txt}
\end{frame}


% Section: Logical Operators
%______________________________________________________________________
\dwSection{Logical Operators}

% Basic Data Types
\begin{dwHeaderFrame}{Logical Values}
	\begin{itemize}
		\item Logical constants in Python: \code{True} and \code{False}.
		\item The value of a logical expression is false, if it returns one of the following:
		\begin{itemize}
			\item The \code{False} constant.
			\item The \code{None} object.
			\item An empty sequence or collection: \code{[]}, \code{()}, \code{`'} ...
			\item The number 0.
		\end{itemize}
		\item Everything else evaluates to \code{True}.
	\end{itemize}
\end{dwHeaderFrame}


\begin{frame}
	\input{00_intro_python/03_tbl/logical_operators}
\end{frame}


% Section: Control Flow
%______________________________________________________________________
\dwSection{Control Flow}

% Conditionals
\begin{dwHeaderFrame}{Conditionals}
	\begin{itemize}
		\item Conditionals are used to branch program execution based on conditions.
		\item \textbf{Indentation is important to define the scope!} If you forget the indentation,
			Python will give you a hint stating that it expects an indented block.
		\item General form of a conditional:
	\end{itemize}
	
	\lstinputlisting{00_intro_python/06_listings/conditionals.txt}
\end{dwHeaderFrame}


% Loops
\begin{dwHeaderFrame}{Loops}
	\begin{itemize}
		\item Loops are used to repetitively execute code (and save a large amount of effort and time).
		\item Python basically distinguishes between two types of loops: The \code{while}-loop and the \code{for}-loop.
			One type of loop can be expressed in terms of the other (\textbf{syntactical sugar}).
	\end{itemize}
	
	\dwHeader{While-loops}
	\begin{itemize}
		\item With the \code{while}-loop we can execute a set of statements as long as a condition is true.
		\item It requires the relevant variables to be initialized (\code{i} in the example below).
		\item Typically used when the number of iterations is not known in advance.
	\end{itemize}
	
	\lstinputlisting{00_intro_python/06_listings/while_loop.txt}
\end{dwHeaderFrame}


\begin{frame}
	\dwHeader{For-loops}
	\begin{itemize}
		\item \code{for}-loops are typically used when the number of iterations is known in advance / when iterating over collections.
		\item The implementation differs from what you know from Java or C.
	\end{itemize}
	
	\lstinputlisting{00_intro_python/06_listings/for_loop.txt}
\end{frame}


% Section: Python OO
%______________________________________________________________________
\dwSection{Python OO}

% Classes
\begin{dwHeaderFrame}{Classes}
	\begin{itemize}
		\item
	\end{itemize}
\end{dwHeaderFrame}


% Section: Machine Learning Libraries
%______________________________________________________________________
\dwSection{Machine Learning Libraries}

% NumPy
\begin{dwHeaderFrame}{NumPy}
	\begin{itemize}
		\item NumPy (Numerical Python) is the fundamental package for scientific computing with Python.
			It is mostly implemented in C and therefore \textbf{very fast}.
		\item It is a library which defines \textbf{multidimensional array objects} (\code{ndarray}) along with functions / routines
			that can operate on those arrays.
		\item The package includes routines for \textbf{linear algebra}, random number generation and many others.
		\item Install the package using \code{pip install numpy}.
	\end{itemize}
\end{dwHeaderFrame}


\begin{frame}
	\dwHeader{ndarray}
	\begin{itemize}
		\item The most important object in NumPy.
		\item Creation of ndarrays (assume: \code{import numpy as np}):
		\begin{itemize}
			\item 0-dimensional: np.array(42)
			\item 1-dimensional: np.array([1, 2, 3])
			\item 2-dimensional: np.array([[1, 2], [3, 4], [5, 6]])
			\item 3-dimensional: np.array([[[1, 2], [3, 4]], [[5, 6], [7, 8]]])
			\item ...
		\end{itemize}
		\item \textcolor{blue}{\textit{What do we call the above objects from a mathematical point of view?}}
		\item If you are interested in the dimensionality of an array you can use \code{ndarray.shape}, e.\,g.: \\
			\code{np.array([[1, 2, 3], [3, 8, 6]]).shape} gives \code{(2, 3)} -- 2 rows, 3 columns.
	\end{itemize}
\end{frame}


\begin{frame}
	\dwHeader{Creation of arrays}
	\begin{itemize}
		\item \textbf{Creation of arrays from scratch:}
		\begin{itemize}
			\item \code{np.empty(shape)}: Creates an empty array (not initialized). It is filled with random numbers.
			\item \code{np.zeros(shape)}: Creates an array of zeros.
			\item \code{np.ones(shape)}: Creates an array of ones.
		\end{itemize}
	\end{itemize}
	\dwAlertBox{The creation of an empty array can lead to strange errors later in your code. I recommend to use the second or third method instead.}
	
	\begin{itemize}
		\item \textbf{Creation of arrays from existing data:}
		\begin{itemize}
			\item \code{np.array(data)}: Creates a copy of \code{data} and converts the copy to an array.
			\item \code{np.asarray(data)}: Uses the original data, changes to the array are reflected in the original data.
		\end{itemize}
	\end{itemize}
\end{frame}


\begin{frame}
	\dwHeader{Indexing}
	\begin{itemize}
		\item \textbf{Standard indexing:}
		\begin{itemize}
			\item Indexing in NumPy is rather simple (in fact it is very similar to standard lists).
			\item This gives you the \textbf{sixth} element from the array: \code{arr[5]} (\textbf{zero-based index!}).
			\item Further dimensions are separated with a comma: \code{arr[5,3]} (fifth row, third column).
			\item A complete row (here: the first one) can be retrieved by: \code{arr[0,:]} or \code{arr[0,...]}
		\end{itemize}
		\item \textbf{Integer indexing:}
	\end{itemize}
	
	\lstinputlisting{00_intro_python/06_listings/integer_indexing.txt}
\end{frame}


\begin{frame}
	\dwHeader{Mathematical operations on arrays (by far not exhaustive!)}
	\vspace*{2mm}
	In the following consider two vectors \code{a = np.array([1, 3, 2])}, \code{b = np.array([4, 1, 0])} and the matrix \code{A = np.array([[1, 3], [3, 1]])}.
	\vspace*{2mm}
	\begin{table}
		\centering
		\renewcommand{\arraystretch}{2.0}
		\begin{tabular}{ l l l l }
			\textbullet & \textbf{Addition:} 		& \code{a + b = np.array([5, 4, 2])} 		& 									\\
			\textbullet & \textbf{Subtraction:} 	& \code{a - b = np.array([-3, 2, 2])} 		& 									\\
			\textbullet & \textbf{Multiplication:} 	& \code{a * b = np.array([4, 3, 0])} 		& \textit{(Hadamard/element-wise product)}	\\
			\textbullet & \textbf{Division:} 		& \code{a / b = np.array([0.25, 3, inf])} 	& 									\\
			\textbullet & \textbf{Inner product:} 	& \code{a @ b = 7} or \code{a.dot(b) = 7}	& \textit{(scalar product)} 					\\
			\textbullet & \textbf{Transpose:} 	& \code{A.T} 						& \textit{(swaps rows and columns)} 			\\
			\textbullet & \textbf{Matrix inverse:} 	& \code{np.linalg.inv(A)} 				& 									\\
		\end{tabular}
	\end{table}
\end{frame}


\begin{frame}
	\dwHeader{Broadcasting}
	\begin{itemize}
		\item The term broadcasting describes how NumPy treats arrays with different shapes during arithmetic operations.
		\item Subject to certain constraints, the smaller array is `broadcast' across the larger array so that they have compatible shapes.
		\item Broadcasting provides a means of \textbf{vectorizing} array operations so that looping occurs in C instead of Python.
		\item NumPy operations are usually done on pairs of arrays on an element-by-element basis:
	\end{itemize}
	\lstinputlisting{00_intro_python/06_listings/broadcasting_intro.txt}
	\begin{itemize}
		\item NumPyâ€™s broadcasting rule \textbf{relaxes this constraint when the arraysâ€™ shapes meet certain constraints}.
		The simplest broadcasting example occurs when an array and a scalar value are combined in an operation:
	\end{itemize}
	\lstinputlisting{00_intro_python/06_listings/broadcasting_example_1.txt}
\end{frame}


\begin{frame}
	\begin{itemize}
		\item NumPy compares the shapes of the arrays element-wise starting with trailing dimensions.
		\item Two dimensions are compatible when
		\begin{itemize}
			\item they are equal,
			\item or one of them is 1.
		\end{itemize}
		\item If these conditions are not met, a \code{ValueError: operands could not be broadcast together} exception is thrown,
			indicating that the arrays have incompatible shapes.
		\item The size of the resulting array is the maximum size along each dimension of the input arrays.
		\item Check out the \externalurl{https://docs.scipy.org/doc/numpy/user/basics.broadcasting.html}{NumPy documentation}!
	\end{itemize}
\end{frame}


% ScikitLearn
\begin{dwHeaderFrame}{ScikitLearn}
	\begin{itemize}
		\item scikit-learn is a Python module for machine learning built on top of SciPy.
		\item The project was started in 2007 by David Cournapeau as a Google Summer of Code project, and since then many volunteers have contributed.
		\item The library implements all common machine learning algorithms (classification, regression, clustering, dimensionality reduction)
			with a standardized API.
		\item Furthermore, functionality for model selection and data pre-processing is included.
		\item Install the library with \code{pip install scikit-learn}
		\item Standard methods all algorithms implement:
		\begin{itemize}
			\item \code{model.fit(X\_train, y\_train)}: Fits the model to the training data. This is called \textbf{training}.
			\item \code{model.predict(X\_test)}: Uses the trained model to get predictions for \textbf{unseen data}.
		\end{itemize}
	\end{itemize}
\end{dwHeaderFrame}


\begin{frame}
	\dwHeader{General procedure}
	\lstinputlisting{00_intro_python/06_listings/scikit_learn_procedure.txt}
\end{frame}


\begin{frame}
	\begin{itemize}
		\item \code{X\_train} must be a two-dimensional array of features: \code{np.array([[...], [...], ...])}.
		\item \code{y\_train} is a one-dimensional array of corresponding class labels, e.\,g.: \code{np.array([0, 1, 1, 0, ...])}
	\end{itemize}
	
	\dwInfoBox{Task: Install scikit-learn and try it for yourself!}
\end{frame}


% Matplotlib
\begin{dwHeaderFrame}{Matplotlib (PyPlot)}
	\begin{itemize}
		\item \code{matplotlib.pyplot} is a collection of command style functions that make matplotlib work like MATLAB.
		\item Each pyplot function makes some change to a figure: e.g., creates a figure, creates a plotting area in a figure,
			plots some lines in a plotting area, decorates the plot with labels, etc.
		\item Generating visualizations with pyplot is very quick (plot on next slide):
	\end{itemize}
	\lstinputlisting{00_intro_python/06_listings/pyplot_example_1.txt}
\end{dwHeaderFrame}


\begin{frame}
	\dwFigure{
		\includegraphics[scale=0.325]{00_intro_python/02_img/pyplot_example_1}	
	}{Simple pyplot example}{fig:pyplot-example-1}
\end{frame}


\begin{frame}
	\begin{itemize}
		\item Plotting in different colors and shapes is quite easy. Some colors and shapes are predefined and can be accessed using string-constants,
			cf. \code{r--} (red dashed), \code{bs} (blue squares) and \code{g\^} (green triangles) below.
		\item Also, Numpy and pyplot go hand in hand:
	\end{itemize}
	\lstinputlisting{00_intro_python/06_listings/pyplot_example_2.txt}
	
	\dwInfoBox{matplotlib.pyplot can handle NumPy arrays! This is very useful, since NumPy arrays are omnipresent in machine learning applications.}
\end{frame}


\begin{frame}
	\dwFigure{
		\includegraphics[scale=0.325]{00_intro_python/02_img/pyplot_example_2}	
	}{A more sophisticated pyplot example}{fig:pyplot-example-2}
\end{frame}


\begin{frame}
	\dwHeader{Plotting contours}
	\begin{itemize}
		\item Contour plots can be useful for plotting decision boundaries of classifiers.
		\item For that you have to create a mesh-grid and classify all points in the grid with your classifier. Matplotlib then assigns a color
			to that point based on the classification result.
		\item Let use make a step-by-step example: 
	\end{itemize}
\end{frame}


\begin{frame}
	\lstinputlisting{00_intro_python/06_listings/pyplot_contours_1.txt}
\end{frame}


\begin{frame}
	\lstinputlisting{00_intro_python/06_listings/pyplot_contours_2.txt}
\end{frame}


\begin{frame}
	\dwFigure{
		\includegraphics[scale=0.325]{00_intro_python/02_img/contour}	
	}{A contour plot in matplotlib}{fig:contour}
\end{frame}


% PyTorch
\begin{dwHeaderFrame}{PyTorch}
	\begin{itemize}
		\item
	\end{itemize}
\end{dwHeaderFrame}


% Thank you
%______________________________________________________________________
\makethanks

\end{document}
