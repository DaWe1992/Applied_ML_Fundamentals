\begin{figure}
	\centering
	\begin{tikzpicture}[
		scale=0.4,
		every node/.style={scale=0.9}
	]
	
		\draw[very thick] (0,0) rectangle (15,10);
		\node at (2,9) {\textbf{Agent}};
		\draw[very thick] (18,0) rectangle (24,10);
		\node at (21,5) {\textbf{Environment}};

		\draw[very thick,->] (21,10) -- (21,12) -- node[below] {Reward} (7.5,12) -- (7.5,10);
		\draw[very thick,->] (21,0) -- (21,-2) -- node[above] {Observe state} (2,-2) -- (2,3.5);
		\draw[very thick,->] (14,3.9) -- node[above right=1mm and -4mm] {Action} (18,3.9);

		\node at (7.5,5) {
			\begin{tikzpicture}[scale=0.175]
				\draw[thick] (-10,1.5) rectangle (-5,7.5);
				\node at (-7.5,4.5) {State};
				\node at (5,14) {DNN};
				\node at (20,14) {$\pi_{\theta}(s, a)$};
				\node at (5,-6) {parameter $\theta$};

				% connections first layer to second layer
				\foreach \y in {-3,0,3,6,9,12}{\draw (0,\y) -- (-5,4.5);}

				% connections second layer to third layer
				\foreach \y in {-3,0,3,6,9,12}{\draw (0,\y) -- (10,-3);}
				\foreach \y in {-3,0,3,6,9,12}{\draw (0,\y) -- (10,0);}
				\foreach \y in {-3,0,3,6,9,12}{\draw (0,\y) -- (10,3);}
				\foreach \y in {-3,0,3,6,9,12}{\draw (0,\y) -- (10,6);}
				\foreach \y in {-3,0,3,6,9,12}{\draw (0,\y) -- (10,9);}
				\foreach \y in {-3,0,3,6,9,12}{\draw (0,\y) -- (10,12);}

				% connections third to fourth layer
				\foreach \y in {-3,0,3,6,9,12}{\draw (10,\y) -- (20,1.5);}
				\foreach \y in {-3,0,3,6,9,12}{\draw (10,\y) -- (20,4.5);}
				\foreach \y in {-3,0,3,6,9,12}{\draw (10,\y) -- (20,7.5);}

				% neurons
				\foreach \y in {-3,0,3,6,9,12}{\node[circle,draw=black,fill=myblue1] at (0,\y) {};}
				\foreach \y in {-3,0,3,6,9,12}{\node[circle,draw=black,fill=myblue1] at (10,\y) {};}
				\foreach \y in {1.5,4.5,7.5}{\node[circle,draw=black,double distance=1pt,fill=myblue1] at (20,\y) {};}
			\end{tikzpicture}
		};
		
	\end{tikzpicture}
\end{figure}