\begin{figure}
	\centering
	\begin{tikzpicture}[
		scale=0.6,
		every node/.style={scale=0.6},
		legal/.style={circle,draw=black,fill=lightgray,minimum size=1cm},
		illegal/.style={circle,draw=black,dashed,minimum size=1cm},
		arr/.style={thick,-stealth,shorten >=2pt,shorten <=2pt},
		arrdash/.style={-stealth,dashed,shorten >=2pt,shorten <=2pt},
		backarr/.style={very thick,myblue1,dashed,-stealth}
	]

		\node at (-2,0) {\scriptsize $q_0$};
		\node at (-2,2) {\scriptsize $q_1$};
		\node at (-2,4) {\scriptsize $q_2$};
		\node at (-2,6) {\scriptsize $q_3$};
		\node at (-2,8) {\scriptsize $q_4$};
		\node at (-2,10) {\scriptsize $q_F$};
	
		% column 1
		\node[legal] (61) at (0,0) {\scriptsize start};
		\node[illegal] (51) at (0,2) {\tiny PPSS};
		\node[illegal] (41) at (0,4) {\scriptsize VB};
		\node[illegal] (31) at (0,6) {\scriptsize TO};
		\node[illegal] (21) at (0,8) {\scriptsize NN};
		\node[illegal] (11) at (0,10) {\scriptsize end};

		% column 2
		\node[illegal] (62) at (3,0) {\scriptsize start};
		\node[legal] (52) at (3,2) {\tiny PPSS};
			\node[myblue1] at (3.5,2.75) {\tiny $v_1(1) = .067 \cdot .37$};
		\node[legal] (42) at (3,4) {\scriptsize VB};
			\node[myblue1] at (3.5,4.75) {\tiny $v_1(2) = .019 \cdot 0$};
		\node[legal] (32) at (3,6) {\scriptsize TO};
			\node[myblue1] at (3.5,6.75) {\tiny $v_1(3) = .0043 \cdot 0$};
		\node[legal] (22) at (3,8) {\scriptsize NN};
			\node[myblue1] at (3.5,8.75) {\tiny $v_1(4) = .041 \cdot 0$};
		\node[illegal] (12) at (3,10) {\scriptsize end};

		\node[rectangle,draw=black,fill=lightgray,minimum size=1cm] at (3,-2) {\textbf{I}};
		\node at (3,-3) {\scriptsize $o_1$};

		% column 3
		\node[illegal] (63) at (10,0) {\scriptsize start};
		\node[legal] (53) at (10,2) {\tiny PPSS};
		\node[legal] (43) at (10,4) {\scriptsize VB};
			\node[myblue1] at (12,5) {\scriptsize $v_2(2) = \max(0,0,0,.0055) \cdot .0093 = .000051$};
		\node[legal] (33) at (10,6) {\scriptsize TO};
		\node[legal] (23) at (10,8) {\scriptsize NN};
		\node[illegal] (13) at (10,10) {\scriptsize end};

		\node[rectangle,draw=black,fill=lightgray,minimum size=1cm] at (10,-2) {\textbf{want}};
		\node at (10,-3) {\scriptsize $o_2$};

		% column 4
		\node[illegal] (64) at (13,0) {\scriptsize start};
		\node[legal] (54) at (13,2) {\tiny PPSS};
		\node[legal] (44) at (13,4) {\scriptsize VB};
		\node[legal] (34) at (13,6) {\scriptsize TO};
		\node[legal] (24) at (13,8) {\scriptsize NN};
		\node[illegal] (14) at (13,10) {\scriptsize end};

		\node[rectangle,draw=black,fill=lightgray,minimum size=1cm] at (13,-2) {\textbf{to}};
		\node at (13,-3) {\scriptsize $o_3$};

		% column 5
		\node[illegal] (65) at (16,0) {\scriptsize start};
		\node[legal] (55) at (16,2) {\tiny PPSS};
		\node[legal] (45) at (16,4) {\scriptsize VB};
		\node[legal] (35) at (16,6) {\scriptsize TO};
		\node[legal] (25) at (16,8) {\scriptsize NN};
		\node[illegal] (15) at (16,10) {\scriptsize end};
		
		\node[rectangle,draw=black,fill=lightgray,minimum size=1cm] at (16,-2) {\textbf{race}};
		\node at (16,-3) {\scriptsize $o_4$};

		% column 6
		\node[illegal] (66) at (19,0) {\scriptsize start};
			\node[myblue1] at (0,-1) {\scriptsize $v_0(0) = 1.0$};
		\node[illegal] (56) at (19,2) {\tiny PPSS};
		\node[illegal] (46) at (19,4) {\scriptsize VB};
		\node[illegal] (36) at (19,6) {\scriptsize TO};
		\node[illegal] (26) at (19,8) {\scriptsize NN};
		\node[legal] (16) at (19,10) {\scriptsize end};

		\draw[arr] (61) -- node[above,rotate=69] {\tiny $p(NN \vert start) \cdot P(start) = .041 \cdot 1 = .041$} (22);
		\draw[arr] (61) -- (32);
		\draw[arr] (61) -- (42);
		\draw[arr] (61) -- (52);

		\draw[arr] (52) -- node[above,rotate=15] {\tiny $v_1(1) \cdot p(VB \vert PPSS) = .025 \cdot .23 = .0055$} (43);
		\draw[arr] (42) -- node[above,rotate=-2] {\tiny $v_1(2) \cdot p(VB \vert VB) = 0 \cdot .0038 = 0$} (43);
		\draw[arr] (32) -- node[above,rotate=-17.5] {\tiny $v_1(3) \cdot p(VB \vert TO) = 0 \cdot .83 = 0$} (43);
		\draw[arr] (22) -- node[above,rotate=-31] {\tiny $v_1(4) \cdot p(VB \vert NN) = 0 \cdot .0040 = 0$} (43);

		\draw[arrdash] (25) -- (16);
		\draw[arrdash] (35) -- (16);
		\draw[arrdash] (45) -- (16);
		\draw[arrdash] (55) -- (16);

		\draw[backarr] (43) .. controls (9,2) .. node[below left=2mm] {\footnotesize \textbf{backtrace}} (52);
		\draw[backarr] (52) .. controls (2,0) .. node[above right=5mm] {\footnotesize \textbf{backtrace}} (61);

	\end{tikzpicture}
\end{figure}